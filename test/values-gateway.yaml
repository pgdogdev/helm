# Test gateway configuration (Enterprise Edition)
gateway:
  enabled: true
  port: 8443
  bindAddress: "0.0.0.0"
  image:
    repository: ghcr.io/pgdogdev/pgdog-enterprise/gateway
    tag: "main-ent"
    pullPolicy: Always
  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi
  tls:
    existingSecret: "gateway-tls-secret"
  control:
    url: "wss://control.example.com/ws"
    token: "test-token-12345"
  stats:
    activeQueriesInterval: 2000
    pingInterval: 1500
    pushInterval: 3000
    configInterval: 5000
  service:
    type: ClusterIP
    annotations:
      service.beta.kubernetes.io/aws-load-balancer-internal: "true"
  nodeSelector:
    node-type: gateway
  tolerations:
    - key: dedicated
      operator: Equal
      value: gateway
      effect: NoSchedule
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app: pgdog-gateway
            topologyKey: kubernetes.io/hostname
  connectFromPgdog: true

# Enable query stats since gateway is enabled
queryStats:
  enabled: true
  queryPlanThreshold: 500
  queryPlanMaxAge: 30000
  queryPlansCache: 200
  maxErrors: 50
  maxErrorAge: 600000

# Basic database config for testing gateway integration
databases:
  - name: primary
    host: postgres.example.com
    port: 5432

users:
  - username: app_user
    password: secret123